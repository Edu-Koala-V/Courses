# 4.3 Użytkownicy, grupy i uprawnienia (LOKALNIE)

## Wprowadzenie

W systemie Windows zarządzanie użytkownikami, grupami i uprawnieniami lokalnie pozwala kontrolować dostęp do zasobów, takich jak pliki, katalogi czy ustawienia systemowe. 
<u>Wszystkie operacje dotyczą lokalnego komputera, nie domeny.</u>

<div data-hint="warning">

Większość komend wymaga uprawnień administratora.
Uruchom **CMD** lub _**Windows Terminal**_ jako administrator.

</div>

## `net user` - Zarządzanie kontami użytkowników

**Składnia**:
```dos
net user [nazwa_użytkownika] [opcje]
```

Wyświetla informacje o użytkownikach. Dodatkowe opcje pozwalają tworzyć, modyfikować i usuwać konta.

---

### Wyświetlanie listy użytkowników
- `net user` - wyświetla listę wszystkich lokalnych kont użytkowników.

**Przykład wyniku**:
```
## Konta użytkowników dla \\Nazwa\Komputera

Administrator            Gość                    JanKowalski
Konto domyślne           WDAGUtilityAccount      Win_Klient

```

### Wyświetlanie szczegółów konta
- `net user JanKowalski` - wyświetla szczegóły konta użytkownika `JanKowalski`.


Porównanie kont użytkownika `JanKowalski` i administratora `Win_Klient`. Na poniższym obrazku wyróżniono kolorystycznie trzy sekcje:
- <span style="color:#00cb06;">Zielony</span>: Ścieszka i wywołana komenda `net user [Nazwa Użytkownika]`.
- <span style="color:#ea4d3d;">Czerwony</span>: Informacje o aktywności i wygasnieciu konta oraz dotyczące hasła użytkownika.
- <span style="color:#e3d63d;">Żółty</span>: Członkostwo grupy na podstawie której rozpoznasz czy użytkownik jest albo nie jest Administratorem.

![Wywołanie net user na dwóch typach użytkowników](https://raw.githubusercontent.com/Edu-Koala-V/images/main/Windows_11/Images/net-user.webp)

### Tworzenie nowego użytkownika

Tworzy konto `NowyUzytkownik` z hasłem `Haslo123`.

```dos
net user NowyUzytkownik Haslo123 /add
```

### Usuwanie użytkownika

Usuwa konto `NowyUzytkownik`.


```dos
net user NowyUzytkownik /delete
```

### Modyfikacja konta

  - `net user JanKowalski /active:no` - dezaktywuje konto `JanKowalski`.
  - `net user JanKowalski /active:yes` - aktywuje konto.
  - `net user JanKowalski NowyHaslo123` - zmienia hasło na `NowyHaslo123`.

<div data-hint="danger">

Hasło musi spełniać wymagania systemowe określone w przystawce `secpol.msc`\!

</div>

## `net localgroup` - Zarządzanie lokalnymi grupami

**Składnia**: 
```dos
net localgroup [nazwa_grupy] [opcje]
```

Pozwala wyświetlać, tworzyć, modyfikować i usuwać lokalne grupy użytkowników.

---

### Wyświetlanie listy grup

- `net localgroup` - wyświetla wszystkie dostępne lokalnie grupy.

![Lokalne grupy](https://raw.githubusercontent.com/Edu-Koala-V/images/main/Windows_11/Images/net-localgroup.webp)

### Wyświetlanie członków grupy

- `net localgroup Administratorzy` - pokazuje członków grupy `Administratorzy`.

Należy zwrócić uwagę na poprawność nazwy grupy. W przeciwieństwie do katalogów domyślnych które są tłumaczone w GUI np.: Desktop na Pulpit, często w konsoli Windowsa należy używać określeń zgodnych z zainstalowanym językiem regionalnym.

![Przynależność do grupy i błąd nazwy](https://raw.githubusercontent.com/Edu-Koala-V/images/main/Windows_11/Images/net-localgroup-error-name.webp)

### Tworzenie nowej grupy

Tworzy grupę `NowaGrupa`.

```dos
net localgroup NowaGrupa /add
```

### Usuwanie grupy

Usuwa grupę `NowaGrupa`.

```dos
net localgroup NowaGrupa /delete
```

### Dodawanie użytkownika do grupy

Dodaje `JanKowalski` do grupy `Administrators`.

```dos
net localgroup Administrators JanKowalski /add
```

### Usuwanie użytkownika z grupy

Usuwa `JanKowalski` z grupy `Administrators`.

```dos
net localgroup Administrators JanKowalski /delete
```

<div data-hint="info">

**Możesz też dodawać i usuwać wielu użytkowników z danej grupy w jednej komendzie.** 

Przykład z dodawaniem wielu użytkowników do grupy lokalnej:
![Przykład z dodawaniem wielu użytkowników do grupy lokalnej.](https://raw.githubusercontent.com/Edu-Koala-V/images/main/Windows_11/Images/net-users-add-to-localgroup.webp)

---

Przykład z usuwaniem wielu użytkowników z grupy lokalnej:

![Przykład z usuwaniem wielu użytkowników z grupy lokalnej](https://raw.githubusercontent.com/Edu-Koala-V/images/main/Windows_11/Images/net-users-delete-form-localgroup.webp)

-----

Dodanie użytkownika do grupy `Administratorzy` daje mu pełne uprawnienia administracyjne na komputerze lokalnym.

</div>

## `icacls` - Zarządzanie uprawnieniami NTFS

**Składnia**: 
```dos
icacls [ścieżka] [opcje]
```

Pozwala wyświetlać i modyfikować listy kontroli dostępu (**ACL** - *Access-control list*) dla plików i katalogów w systemie plików **`NTFS`**.

<div data-hint="warning">

Komenda `icacls` działa tylko na systemie plików NTFS. Na FAT32 uprawnienia nie są obsługiwane.

</div>

---

### Wyświetlanie uprawnień

Wyświetla uprawnienia dla katalogu pulpitu użytkownika `Win_Klient`.

```dos
icacls Desktop
```

**Przykład użycia (koloryzowane)**:

![Przykład użycia icacls (koloryzowane)](https://raw.githubusercontent.com/Edu-Koala-V/images/main/Windows_11/Images/icacls-desktop-color-perm.webp)

**Objaśnienie**:

  - `(I)` - **Dziedziczenie**: Ten katalog lub plik dziedziczy uprawnienia z nadrzędnego katalogu.
  - `(OI)` - **Dziedziczenie obiektów**: Pliki w tym katalogu będą dziedziczyć jego uprawnienia.
  - `(CI)` - **Dziedziczenie kontenerów**: Podkatalogi tego katalogu będą dziedziczyć jego uprawnienia.
  - `(F)` - **Pełna kontrola**: Możność modyfikacji, zapisu, odczytu, wykonania, usunięcia itd.

### Nadawanie uprawnień

Nadaje użytkownikowi `JanKowalski` pełną kontrolę nad `Folder`.

```dos
icacls C:\Folder /grant JanKowalski:F
```

### Usuwanie uprawnień

Blokuje użytkownikowi `JanKowalski` pełną kontrolę nad `Folder`.

```dos
icacls C:\Folder /deny JanKowalski:F
```

### Resetowanie uprawnień

Przywraca domyślne uprawnienia dla `Folder`.

```dos
icacls C:\Folder /reset
```

### Uprawnienia rekurencyjne

Dodanie opcji `/T` wykona polecenie rekurencyjnie nadaje uprawnienia do wszystkich jego podkatalogów/plików.

```dos
icacls C:\Folder /grant JanKowalski:F /T
```

## Rodzaje uprawnień Windows NTFS

---

### Tabela 1: Najważniejsze i najczęściej używane uprawnienia (podstawowe)

| Uprawnienie | Opis |
|-------------|------|
| **N**           | Brak dostępu |
| **F**           | Pełna kontrola (odczyt, zapis, wykonywanie, usuwanie, zmiana uprawnień itd.) |
| **M**           | Modyfikacja (odczyt, zapis, wykonywanie, usuwanie) |
| **RX**          | Odczyt i wykonywanie (odczyt danych i uruchamianie plików) |
| **R**           | Tylko odczyt (odczyt danych bez możliwości zapisu) |
| **W**           | Tylko zapis (zapis danych bez możliwości odczytu) |
| **D**           | Usuwanie (możliwość usuwania pliku lub katalogu) |

<div data-hint="info">

Te uprawnienia są najczęściej używane w poleceniach takich jak `icacls`, ponieważ są proste i obejmują większość typowych scenariuszy zarządzania dostępem.

</div>

### Tabela 2: Pozostałe uprawnienia (zaawansowane i dziedziczenie)


Zaawansowane uprawnienia i uprawnienia dziedziczenia są używane w bardziej specyficznych scenariuszach, np. przy precyzyjnym zarządzaniu dostępem w środowiskach korporacyjnych.
Dlatego na poziomie Technik Informatyk nie musisz ich znać i używać, ale prezentuję je dla pełnego zakresu wiedzy.


| Uprawnienie | Opis |
|-------------|------|
| **(DE)**          | Usuwanie pliku lub katalogu |
| **(RC)**          | Odczyt uprawnień (kontrola odczytu) |
| **(WDAC)**        | Zmiana uprawnień (zapis **DAC** - *Discretionary Access Control*) |
| **(WO)**          | Przejmowanie własności (zapis właściciela) |
| **(S)**           | Synchronizacja (używane w operacjach wielowątkowych) |
| **(AS)**          | Dostęp do zabezpieczeń systemowych |
| **(MA)**          | Maksymalne dozwolone uprawnienia** |
| **(GR)**          | Ogólny odczyt |
| **(GW)**          | Ogólny zapis |
| **(GE)**          | Ogólne wykonywanie |
| **(GA)**          | Ogólny pełny dostęp |
| **(RD)**          | Odczyt danych (dla plików) lub listowanie katalogu (dla katalogów) |
| **(WD)**          | Zapis danych (dla plików) lub dodawanie pliku (dla katalogów) |
| **(AD)**          | Dołączanie danych (dla plików) lub dodawanie podkatalogu (dla katalogów) |
| **(REA)**         | Odczyt rozszerzonych atrybutów |
| **(WEA)**         | Zapis rozszerzonych atrybutów |
| **(X)**           | Wykonywanie (dla plików) lub przemierzanie (dla katalogów) |
| **(DC)**          | Usuwanie elementów podrzędnych (tylko dla katalogów) |
| **(RA)**          | Odczyt atrybutów |
| **(WA)**          | Zapis atrybutów |

| Uprawnienia dziedziczenia | Opis |
|-------------|------|
| **(I)**         | Dziedziczenie - wpis **ACL** odziedziczony z kontenera nadrzędnego |
| **(OI)**        | Dziedziczenie obiektów - obiekty w kontenerze dziedziczą ten wpis **ACL** (tylko dla katalogów) |
| **(CI)**        | Dziedziczenie kontenerów - kontenery w nadrzędnym kontenerze dziedziczą ten wpis **ACL** (tylko dla katalogów) |
| **(IO)**        | Tylko dziedziczenie - wpis **ACL** jest dziedziczony, ale nie dotyczy samego obiektu (tylko dla katalogów) |
| **(NP)**        | Brak propagacji dziedziczenia - wpis **ACL** jest dziedziczony przez kontenery i obiekty, ale nie propaguje się do zagnieżdżonych kontenerów (tylko dla katalogów) |

---

# Podcast AI

<audio src="https://raw.githubusercontent.com/Edu-Koala-V/audio_podcast/refs/heads/main/Windows_11/Audio/Windows_ Local Users, Groups, and Permissions Management.wav" controls>
Twoja przeglądarka nie wspiera odtwarzania plików audio.
</audio>