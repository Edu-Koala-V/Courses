# 6.5 Instrukcje iteracyjne

## Wprowadzenie

Ptle w _**PowerShell**_, podobnie jak `FOR /L` i `FOR /F` w **BATCH**, umo偶liwiaj wielokrotne wykonywanie fragment贸w kodu.  
_**PowerShell**_ oferuje:
- `foreach` do przetwarzania kolekcji (odpowiednik `FOR /F`)
- `for` do zliczania (jak `FOR /L`)
- `while` do wykonywania ptli dop贸ki warunek jest speniony. 

Aby przerwa dziaanie ptli, w _**PowerShell**_ su偶y do tego `break`, podczas gdy w **BATCH** u偶ywae `EXIT /B`.

## Definicje

<div data-hint="info">

**Instrukcja iteracyjna**: Polecenie, kt贸re powtarza dany blok kodu okrelon liczb razy lub dop贸ki speniony jest warunek.

</div>

<div data-hint="info">

**Kolekcja**: Zbi贸r danych, takich jak tablica, kt贸ra przechowuje wiele element贸w, np. `$kolekcja = "Adam", "Ewa"`.

</div>


## Podstawowa skadnia

| Instrukcja | Opis | Przykad |
| :--- | :--- | :--- |
| `foreach` | Przetwarza ka偶dy element kolekcji (jak `FOR /F` w **BATCH**). | `foreach ($imie in $kolekcja) { Write-Output $imie }` |
| `for` | Powtarza kod okrelon liczb razy (jak `FOR /L` w **BATCH**). | `for ($i = 0; $i -lt 5; $i++) { Write-Output $i }` |
| `while` | Powtarza kod, dop贸ki warunek jest prawdziwy. | `while ($licznik -lt 5) { Write-Output $licznik }` |
| `break` | Natychmiast przerywa dziaanie ptli (jak `EXIT /B` w **BATCH**). | `if ($imie -eq "Janek") { break }` |


## Przykad: Ptla `foreach`

Ptla `foreach` jest idealna do przetwarzania ka偶dego elementu w kolekcji.

```powershell
$kolekcja = "Marcel", "Ania", "Kamil"
foreach ($imie in $kolekcja) {
    Write-Output "Cze, $imie!"
}
Read-Host "Wcinij Enter aby zakoczy dziaanie."
```

![Wynik ptli foreach](https://raw.githubusercontent.com/Edu-Koala-V/images/main/Windows_11/Images/powershell-foreach-wynik.webp)


## Przykad: Ptla `for` z `break`

- Ptla `for` jest doskonaa do powtarzania operacji okrelon liczb razy.  
- Poni偶szy kod zawiera kolekcj 10 emoji zwierzt.  
- Ptla `for` iteruje od $$0$$ (poniewa偶 pierwszy element ma *indeks* $$0$$) do momentu, gdy `$i` jest mniejsze lub r贸wne $$9$$.  
- W ptli, instrukcja `if` sprawdza, czy `$i` jest r贸wne $$4$$, a jeli tak, to wywouje `break`, przerywajc dziaanie ptli.

```powershell
$emoji = "", "", "", "", "Λ", "", "", "", "", ""
for ($i = 0; $i -le 9; $i++) {
    if ($i -eq 4) { break }
    Write-Output "Liczba: $i $($emoji[$i])"
}
Read-Host "Wcinij Enter aby zakoczy dziaanie."
```

![Wynik ptli for z break](https://raw.githubusercontent.com/Edu-Koala-V/images/main/Windows_11/Images/powershell-for-break-wynik.webp)


## Przykad: Ptla `while`

Ptla `while` powtarza kod tak dugo, jak warunek jest prawdziwy. Pamitaj, aby zawsze umieci w jej wntrzu operacj, kt贸ra zmieni warunek i pozwoli na jej zakoczenie, by unikn 撅 nieskoczonej ptli.

```powershell
$licznik = 1
while ($licznik -le 5) {
    Write-Output "Licznik: $licznik"
    $licznik++
}
Read-Host "Wcinij Enter aby zakoczy dziaanie."
```

![Wynik ptli while](https://raw.githubusercontent.com/Edu-Koala-V/images/main/Windows_11/Images/powershell-while-wynik.webp)

<div data-hint="info">

`++` w programowaniu nazywa si **inkrementacj** i oznacza zwikszenie wartoci o $$1$$.  
Przeciwiestwem inkrementacji jest **dekrementacja** (`--`), czyli zmniejszenie wartoci o $$1$$.

</div>

-----

## Funkcja z ptl

Poni偶szy przykad czy wiele poznanych dotychczas koncepcji: funkcje, ptle i obsug bd贸w. Skrypt iteruje po kolekcji nazw u偶ytkownik贸w i sprawdza, czy istniej w systemie.

```powershell
function Test-LocalUsers {
    param($kolekcja)
    foreach ($nazwa in $kolekcja) {
        try {
            $user = Get-LocalUser -Name $nazwa -ErrorAction Stop
            Write-Output "U偶ytkownik $nazwa istnieje!"
        }
        catch {
            Write-Output "U偶ytkownik $nazwa nie istnieje!"
        }
    }
}

$kolekcja = "Administrator", "Adam", "Go", "Ewa"
Test-LocalUsers -kolekcja $kolekcja
Read-Host "Wcinij Enter aby zakoczy dziaanie."
```

![Wynik dziaania skryptu sprawdzajcego czy u偶ytkownicy z kolekcji istniej w systemie](https://raw.githubusercontent.com/Edu-Koala-V/images/main/Windows_11/Images/powershell-foreach-function-check-users.webp)

---

# Podcast AI

<audio src="https://raw.githubusercontent.com/Edu-Koala-V/audio_podcast/refs/heads/main/Windows_11/Audio/PowerShell Iteration_ Loops, ForEach, For, While, and Break.wav" controls>
Twoja przegldarka nie wspiera odtwarzania plik贸w audio.
</audio>