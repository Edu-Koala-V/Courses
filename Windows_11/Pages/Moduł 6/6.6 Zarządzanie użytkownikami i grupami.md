# 6.6 Zarządzanie użytkownikami i grupami

# Wprowadzenie

_**PowerShell**_ zastępuje polecenia **CMD**/**BATCH** (np. `net user`, `net localgroup`) oraz interfejs graficzny (`lusrmgr.msc`) w zarządzaniu użytkownikami i grupami.

## Zarządzanie użytkownikami

---

### Pobieranie informacji o użytkownikach

`Get-LocalUser`: to podstawowe polecenie do pobierania informacji o użytkownikach lokalnych na komputerze.

<div data-tabs>
<div class="tabs">
<b>PowerShell</b>
<b>Skrypt PS1</b>
</div>
<div class="active">

```powershell
Get-LocalUser
```

Możesz również pobrać informacje o konkretnym użytkowniku, podając jego nazwę.

```powershell
Get-LocalUser -Name "WinKlient"
```
![Wynik powyższej komendy](https://raw.githubusercontent.com/Edu-Koala-V/images/main/Windows_11/Images/powershell-Get-LocalUser-name.webp)

</div>
<div>

```powershell
try {
    $user = Get-LocalUser -Name "Adam" -ErrorAction Stop
    Write-Output "Użytkownik $user istnieje!"
}
catch {
    Write-Output "Błąd: $($_.Exception.Message)"
}
Read-Host "Wciśnij Enter aby zakończyć działanie."
```
![Wynik powyższego skryptu](https://raw.githubusercontent.com/Edu-Koala-V/images/main/Windows_11/Images/powershell-Get-LocalUser-script.webp)

</div>
</div>

-----

### Tworzenie użytkownika

`New-LocalUser`: to polecenie do tworzenia nowego konta użytkownika lokalnego.

<div data-hint="success">

**Pamiętaj, aby hasło podać w bezpiecznym formacie.**

`ConvertTo-SecureString` przekształca hasło w tekstowym formacie na bezpieczny obiekt, który jest wymagany przez `New-LocalUser`.

</div>

<div data-tabs>
<div class="tabs">
<b>PowerShell</b>
<b>Skrypt PS1</b>
</div>
<div class="active">

```powershell
$password = ConvertTo-SecureString "P@ssw0rd" -AsPlainText -Force
New-LocalUser -Name "Janek" -Password $password -FullName "Jan Kowalski" -Description "Użytkownik testowy"
```
![Wynik powyższej komendy](https://raw.githubusercontent.com/Edu-Koala-V/images/main/Windows_11/Images/powershell-New-LocalUser.webp)

</div>
<div>

```powershell
try {
    $password = ConvertTo-SecureString "P@ssw0rd" -AsPlainText -Force
    New-LocalUser -Name "Adam" -Password $password -FullName "Adam Nowak" -Description "Użytkownik testowy"
    Write-Output "Użytkownik Adam utworzony!"
}
catch {
    Write-Output "Błąd: $($_.Exception.Message)"
}
Read-Host "Wciśnij Enter aby zakończyć działanie."
```
![Wynik powyższego skryptu](https://raw.githubusercontent.com/Edu-Koala-V/images/main/Windows_11/Images/powershell-New-LocalUser-script.webp)

</div>
</div>



-----

### Usuwanie użytkownika

`Remove-LocalUser`: to polecenie służy do usuwania użytkownika lokalnego.

<div data-tabs>
<div class="tabs">
<b>PowerShell</b>
<b>Skrypt PS1</b>
</div>
<div class="active">

```powershell
Remove-LocalUser -Name "Janek"
```
![Wynik powyższej komendy](https://raw.githubusercontent.com/Edu-Koala-V/images/main/Windows_11/Images/powershell-Remove-LocalUser.webp)

</div>
<div>

```powershell
try {
    Remove-LocalUser -Name "Adam" -ErrorAction Stop
    Write-Output "Użytkownik Adam usunięty!"
}
catch {
    Write-Output "Błąd: $($_.Exception.Message)"
}
Read-Host "Wciśnij Enter aby zakończyć działanie."
```
![Wynik powyższego skryptu](https://raw.githubusercontent.com/Edu-Koala-V/images/main/Windows_11/Images/powershell-Remove-LocalUser-script.webp)

</div>
</div>

-----

## Zarządzanie grupami

---

### Tworzenie grupy

`New-LocalGroup`: to polecenie, które tworzy nową grupę lokalną.

<div data-tabs>
<div class="tabs">
<b>PowerShell</b>
<b>Skrypt PS1</b>
</div>
<div class="active">

```powershell
New-LocalGroup -Name "TestGroup" -Description "Grupa testowa"
```
![Wynik powyższej komendy](https://raw.githubusercontent.com/Edu-Koala-V/images/main/Windows_11/Images/powershell-New-LocalGroup.webp)

</div>
<div>

```powershell
try {
    New-LocalGroup -Name "TestScriptGroup" -Description "Grupa testowa poprzez skrypt" -ErrorAction Stop
    Write-Output "Grupa TestScriptGroup utworzona!"
}
catch {
    Write-Output "Błąd: $($_.Exception.Message)"
}
Read-Host "Wciśnij Enter aby zakończyć działanie."
```
![Wynik powyższego skryptu](https://raw.githubusercontent.com/Edu-Koala-V/images/main/Windows_11/Images/powershell-New-LocalGroup-script.webp)

</div>
</div>

-----

### Dodawanie do grupy

`Add-LocalGroupMember`: to polecenie, które dodaje użytkownika do wybranej grupy lokalnej.

<div data-tabs>
<div class="tabs">
<b>PowerShell</b>
<b>Skrypt PS1</b>
</div>
<div class="active">

```powershell
Add-LocalGroupMember -Group "TestGroup" -Member "Janek"
```
![Wynik powyższej komendy](https://raw.githubusercontent.com/Edu-Koala-V/images/main/Windows_11/Images/powershell-Add-LocalGroupMember.webp)

</div>
<div>

```powershell
try {
    Add-LocalGroupMember -Group "TestScriptGroup" -Member "Adam" -ErrorAction Stop
    Write-Output "Adam dodany do grupy TestScriptGroup!"
}
catch {
    Write-Output "Błąd: $($_.Exception.Message)"
}
Read-Host "Wciśnij Enter aby zakończyć działanie."
```
![Wynik powyższego skryptu](https://raw.githubusercontent.com/Edu-Koala-V/images/main/Windows_11/Images/powershell-Add-LocalGroupMember-script.webp)

</div>
</div>


### Usuwanie grupy

`Remove-LocalGroup`: to polecenie, które służy do usuwania grupy lokalnej.

<div data-tabs>
<div class="tabs">
<b>PowerShell</b>
<b>Skrypt PS1</b>
</div>
<div class="active">

```powershell
Remove-LocalGroup -Name "TestGroup"
```
![Wynik powyższej komendy](https://raw.githubusercontent.com/Edu-Koala-V/images/main/Windows_11/Images/powershell-Remove-LocalGroup.webp)

</div>
<div>

```powershell
try {
    Remove-LocalGroup -Name "TestScriptGroup" -ErrorAction Stop
    Write-Output "Grupa TestScriptGroup usunięta!"
}
catch {
    Write-Output "Błąd: $($_.Exception.Message)"
}
Read-Host "Wciśnij Enter aby zakończyć działanie."
```
![Wynik powyższego skryptu](https://raw.githubusercontent.com/Edu-Koala-V/images/main/Windows_11/Images/powershell-Remove-LocalGroup-script.webp)

</div>
</div>


# Ważna uwaga

Po utworzeniu nowego użytkownika za pomocą `New-LocalUser`, konto (o ile jest aktywne) pozwala na uruchamianie programów za pomocą dobrze znanej komendy z **CMD**, czyli `runas`, oraz na autoryzację w udziałach sieciowych.

Jednak domyślnie, taki użytkownik nie zaloguje się poprzez interfejs graficzny (**GUI**), ponieważ ta możliwość jest przypisana wyłącznie członkom grupy **"Użytkownicy"**.

Aby umożliwić logowanie przez **GUI**, musisz ręcznie dodać nowo utworzonego użytkownika do tej grupy za pomocą poniższej komendy:

```powershell
Add-LocalGroupMember -Group "Użytkownicy" -Member "NazwaUżytkownika"
```

---


# Podcast AI

<audio src="https://raw.githubusercontent.com/Edu-Koala-V/audio_podcast/refs/heads/main/Windows_11/Audio/PowerShell User and Group Management.wav" controls>
Twoja przeglądarka nie wspiera odtwarzania plików audio.
</audio>