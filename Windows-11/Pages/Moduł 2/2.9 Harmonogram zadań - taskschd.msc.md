# 2.9 Harmonogram zadań - `taskschd.msc`

## Wprowadzenie

<img src="https://raw.githubusercontent.com/Edu-Koala-V/images/main/Windows_11/Images/taskschd-ico.webp" alt="Ikona Harmonogramu zadań" style="display: inline-block; height: 1.2rem; vertical-align: middle;"> **Harmonogram zadań** (`taskschd.msc`) to przystawka umożliwiająca automatyzację operacji, takich jak uruchamianie programów, wykonywanie skryptów czy realizacja zadań konserwacyjnych. Działa w oparciu o usługę systemową `Schedule`, która monitoruje *triggery* (wyzwalacze) i wykonuje zdefiniowane akcje.

Choć jest nieco przestarzały, **Harmonogram zadań** pozostaje integralną częścią systemu _**Windows**_, obsługując zarówno zadania systemowe, jak i te tworzone przez aplikacje firm trzecich.

---

## Uruchamianie Harmonogramu zadań

Przystawkę można uruchomić na kilka sposobów:

- **Wyszukiwarka**: Naciśnij <span style="white-space: nowrap;"><kbd class="Win"></kbd> + <kbd>S</kbd></span>, wpisz *"Harmonogram zadań"* i kliknij aplikację.
- **Uruchom**: Naciśnij <span style="white-space: nowrap;"><kbd class="Win"></kbd> + <kbd>R</kbd></span>, wpisz `taskschd.msc` i naciśnij <kbd>Enter</kbd>.
- **Menu Start**: Kliknij prawym przyciskiem na __*Windows Start*__ <img src="https://raw.githubusercontent.com/Edu-Koala-V/images/main/Windows_11/Images/windows_11_logo.png" alt="Windows Logo" style="display: inline-block; height: 1.2rem; vertical-align: middle;">, wybierz *Zarządzanie komputerem*, a potem *Harmonogram zadań*.
- <img src="https://raw.githubusercontent.com/Edu-Koala-V/images/main/Windows_11/Images/file-explorer-icon.png" alt="Ikona Eksploratora plików" style="display: inline-block; height: 1.2rem; vertical-align: middle;"> **Eksplorator plików**: Przejdź do `C:\Windows\System32`, kliknij dwukrotnie `taskschd.msc`.

![Programik taskschd.msc uruchamiający Harmonogram zadań](https://raw.githubusercontent.com/Edu-Koala-V/images/main/Windows_11/Images/plik-taskschd.msc.webp)

---

## Interfejs Harmonogramu zadań

Okno **Harmonogramu zadań** składa się z trzech głównych elementów:

- **Biblioteka Harmonogramu zadań**: Lewy panel z drzewem folderów, w których pogrupowane są zestawy zadań, których podgląd możesz zobaczyć na środku. Możesz też stworzyć w tej hierarchii swój katalog na własne zadania.
- **Lista zadań**: Środkowy panel jest podzielony na pół poziomą belką.
    - W górnej strefie masz wszystkie zadania w aktualnie wybranym katalogu.
    - Natomiast poniżej masz pogrupowane w zakładki właściwości i informacje wybranego zadania.
- **Panel akcji**: Prawy panel zawiera opcje, takie jak:
    - *Utwórz podstawowe zadanie*
    - *Utwórz zadanie*
    - *Importuj zadanie*
    - *Wyświetl wszystkie uruchomione zadania*.

![Interfejs Harmonogramu zadań](https://raw.githubusercontent.com/Edu-Koala-V/images/main/Windows_11/Images/taskschd.msc.webp)

---

## Mechanizmy działania

**Harmonogram zadań** opiera się na usłudze systemowej `Schedule` (widocznej w `services.msc` pod nazwą "*Harmonogram zadań*"), która działa w tle i monitoruje wyzwalacze, takie jak czas czy zdarzenia systemowe. Zadania są zapisywane jako pliki **`XML`** w folderze <span style="white-space: nowrap;">`C:\Windows\System32\Tasks`</span> oraz w rejestrze pod kluczem <span style="white-space: nowrap;">`HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache`</span>.

<details>
<summary>Przykładowa zawartość pliku .XML zadania dla aktualizacji w tle przeglądarki internetowej Mozilla Firefox</summary>

```xml
<?xml version="1.0" encoding="UTF-16"?>
<Task version="1.6" xmlns="[http://schemas.microsoft.com/windows/2004/02/mit/task](http://schemas.microsoft.com/windows/2004/02/mit/task)">
  <Triggers>
    <TimeTrigger>
      <StartBoundary>2025-03-17T19:59:00.610Z</StartBoundary>
      <Repetition>
        <Interval>PT25200S</Interval>
      </Repetition>
    </TimeTrigger>
  </Triggers>
  <Actions Context="Author">
    <Exec>
      <Command>C:\Program Files\Mozilla Firefox\firefox.exe</Command>
      <Arguments>--MOZ_LOG sync,prependheader,timestamp,append,maxsize:1,Dump:5 --MOZ_LOG_FILE C:\ProgramData\Mozilla-1de4eec8-A420-4177-a864-e594e8d1fb38\updates\328046C5FF4A36CB\backgroundupdate.moz_log --backgroundtask backgroundupdate</Arguments>
      <WorkingDirectory>C:\ProgramData\Mozilla-1de4eec8-1234-2137-a864-e594e8d1fb38\updates\328046C5FF4A36CB</WorkingDirectory>
    </Exec>
  </Actions>
  <Settings>
    <StartWhenAvailable>true</StartWhenAvailable>
    <MultipleInstancesPolicy>IgnoreNew</MultipleInstancesPolicy>
    <ExecutionTimeLimit>PT1200S</ExecutionTimeLimit>
  </Settings>
  <RegistrationInfo>
    <Author>Mozilla</Author>
    <Description>Zadanie aktualizacji w tle wyszukuje aktualizacje programu Firefox, kiedy nie jest on włączony. To zadanie jest automatycznie instalowane przez program Firefox i jest ponownie instalowane po jego włączeniu. Aby je wyłączyć, zaktualizuj ustawienia przeglądarki lub ustawienie „BackgroundAppUpdate” zasad organizacji w programie Firefox.</Description>
    <URI>\Mozilla\Firefox Background Update S-1-5-21-2058178053-1291677794-1729450686-1001 308046B0AF4A39CB</URI>
  </RegistrationInfo>
  <Principals>
    <Principal id="Author">
      <UserId>PC\Gapisz mi się na bebech?</UserId>
      <LogonType>InteractiveToken</LogonType>
      <RunLevel>LeastPrivilege</RunLevel>
    </Principal>
  </Principals>
</Task>
```

</details>

<div data-hint="info">

**Ciekawostka**: Możesz włączyć historię zadań w menu <kbd class="os-ui">Akcja</kbd> > <kbd class="os-ui">Włącz wszystkie historie zadań</kbd>, aby śledzić szczegóły w **Podglądzie zdarzeń**.

</div>

<div data-hint="danger">

**Uwaga!!!**  
Wyłączenie usługi `Schedule` uniemożliwi działanie wszystkich zaplanowanych zadań, w tym systemowych, takich jak aktualizacje czy optymalizacja dysku.

</div>

-----

## Wyzwalacze Harmonogramu zadań

**Harmonogram zadań** oferuje różne wyzwalacze, które określają, kiedy zadanie się uruchomi.  
Poniżej tabela z kluczowymi wyzwalaczami i ich zastosowaniami:

| Wyzwalacz | Opis |
|---|---|
| **Harmonogram** | Uruchamia zadanie w określonych odstępach czasu. |
| **Przy logowaniu** | Startuje po zalogowaniu użytkownika. |
| **Przy uruchamianiu** | Działa przy starcie systemu. |
| **Na zdarzenie** | Reaguje na zdarzenie w systemie. |
| **Przy bezczynności** | Wykonuje się, gdy komputer nie jest używany. |
| **Jednorazowo** | Uruchamia się raz w określonym terminie. |

---

## Tworzenie zadań

**Harmonogram zadań** umożliwia tworzenie zadań podstawowych i zaawansowanych.

Podstawowe zadania są proste i idealne dla początkujących. Kreator prowadzi przez proces krok po kroku.
Możesz też dodać nowe zadanie "zaawansowane" i skonfigurować je w widoku **Właściwości zadania**.

### Przykład automatycznego uruchamiania czyszczenia partycji

1.  W przystawce **Harmonogram zadań** dodaj nowy katalog w hierarchii i utwórz w nim podstawowe zadanie klikając <kbd class="win-menu-btn">Utwórz podstawowe zadanie…</kbd> z menu kontekstowego lub prawego panelu akcji.

![Nowe zadanie podstawowe w Harmonogramie zadań](https://raw.githubusercontent.com/Edu-Koala-V/images/main/Windows_11/Images/taskschd.msc-new-basic-task.webp)

---

2.  W oknie kreatora uzupełnij nazwę zadania i opcjonalnie opis.   
  Przykładowo:
      - Nazwa zadania: *"Co tygodniowe czyszczenie dysku"*
      - Opis: *"Raz w tygodniu usuwa pliki tymczasowe i inne śmieci np.: z kosza."*

![Kreator nowego zadania podstawowego w Harmonogramie zadań](https://raw.githubusercontent.com/Edu-Koala-V/images/main/Windows_11/Images/taskschd.msc-new-basic-task-1.webp)

---

3.  Wybierz odpowiedni *trigger*.

![Kreator nowego zadania podstawowego w Harmonogramie zadań - wybór wyzwalacza](https://raw.githubusercontent.com/Edu-Koala-V/images/main/Windows_11/Images/taskschd.msc-new-basic-task-2.webp)

---

4.  Ustaw datę pierwszego uruchomienia, określ, co ile tygodni i w jakim dniu ma się uruchamiać ponownie.

![Kreator nowego zadania podstawowego w Harmonogramie zadań - określenie terminu](https://raw.githubusercontent.com/Edu-Koala-V/images/main/Windows_11/Images/taskschd.msc-new-basic-task-3.webp)
   

<div data-hint="info">

Przy tworzeniu podstawowego zadania, gdyby komputer nie był włączony w wyznaczonym czasie, zadanie zostanie pominięte, chyba że potem zaznaczysz opcję, aby je wykonać od razu przy uruchomieniu systemu, gdy termin minie.

</div>

---

5.  Zdecyduj o akcji do wykonania. Wszystko poza uruchomieniem programu jest przestarzałe.

![Kreator nowego zadania podstawowego w Harmonogramie zadań - zdecydowanie o akcji do wykonania](https://raw.githubusercontent.com/Edu-Koala-V/images/main/Windows_11/Images/taskschd.msc-new-basic-task-4.webp)

---

6.  Możesz na dwa sposoby wskazać program/skrypt do uruchomienia.
      - Podając jego nazwę `cleanmgr.exe`, a następnie wskazując lokalizację katalogu, w którym się znajduje `C:\Windows\System32`, w opcjonalnym polu *"Rozpocznij w"*.
      - Podając pełną ścieżkę bezwzględną lokalizacji programu lub skryptu do uruchomienia.

Jako argument podaj uruchomienie profilu w programie **Oczyszczanie dysku**: `/sagerun:1`.

![Kreator nowego zadania podstawowego w Harmonogramie zadań - zdecydowanie co i z jakimi argumentami ma zostać uruchomione](https://raw.githubusercontent.com/Edu-Koala-V/images/main/Windows_11/Images/taskschd.msc-new-basic-task-5.webp)


---

7.  Na ostatniej stronie kreatora zobaczysz podsumowanie.

![Kreator nowego zadania podstawowego w Harmonogramie zadań - podsumowanie kreatora](https://raw.githubusercontent.com/Edu-Koala-V/images/main/Windows_11/Images/taskschd.msc-new-basic-task-6.webp)

---

1.  Jak na razie zadanie nie będzie działać w pełni poprawnie. Ponieważ musisz jeszcze utworzyć profil z zaznaczeniem, co ma zostać usunięte. Dlatego uruchom konsolę poleceń **CMD** i wpisz:
    ```cmd
    cleanmgr.exe /sageset:1
    ```
     Uruchomi się **Oczyszczanie dysków**. Teraz zaznacz, które opcje mają zostać usunięte, i wykonaj oczyszczanie, aby profil się zapisał.
    Możesz rozszerzyć wybór o pliki systemowe, klikając na: <img src="https://raw.githubusercontent.com/Edu-Koala-V/images/main/Windows_11/Images/oczyszczanie-plików-systemowych.webp" alt="Windows Logo" style="display: inline-block; height: 1.2rem; vertical-align: middle;">

![Kreator nowego zadania podstawowego w Harmonogramie zadań - podsumowanie kreatora](https://raw.githubusercontent.com/Edu-Koala-V/images/main/Windows_11/Images/taskschd.msc-new-basic-task-7.webp)


<div data-hint="success">

Argumenty dla oczyszczania dysku `cleanmgr.exe` (numer to identyfikator profilu):

```powershell
cleanmgr.exe /sageset:1 <--"Ustaw profil 1 Oczyszczania dysku"
cleanmgr.exe /sagerun:1 <--"Uruchom profil 1 Oczyszczania dysku"
```

</div>

### Efekt uruchomienia zadania

Od teraz w każdą niedzielę o godzinie $$16:00$$ uruchomią się po dwa okienka dla każdej z Twoich partycji.
![Uruchomienie się zadania oczyszczanie wszystkich partycji](https://raw.githubusercontent.com/Edu-Koala-V/images/main/Windows_11/Images/oczyszczanie-plików-na-partycjach.webp)

<div data-hint="danger">

**UWAGA** domyślnie zadanie zostanie pominięte, gdy np. komputer nie będzie uruchomiony w danym terminie.

Jeśli zadanie zostanie pominięte, możesz zaznaczyć, aby uruchomiło się przy pierwszej możliwej opcji. Zaznacz wtedy checkbox 
<span style="white-space: nowrap;"><kbd class="check-mark"></kbd> *Uruchom szybko zadanie, jeśli pominięto zaplanowane uruchamianie*</span> we właściwościach zadania, w zakładce <kbd class="win-menu-btn">Ustawienia</kbd>.

</div>

![Jeżeli zadanie zostanie pominiete to możesz zaznaczyć aby uruchomiło się przy pierwszej możliwej opcji.](https://raw.githubusercontent.com/Edu-Koala-V/images/main/Windows_11/Images/taskschd.msc-if-skip-task.webp)


-----

## Postscriptum

***Windows*** wykorzystuje **Harmonogram zadań** do kluczowych operacji konserwacyjnych i optymalizacyjnych, przechowywanych w folderze `Microsoft\Windows` w **Bibliotece Harmonogramu zadań**. Oto najważniejsze zadania systemowe:

  - **Scheduled Start** (`Microsoft\Windows\WindowsUpdate`): Sprawdza i instaluje aktualizacje systemu, zapewniając bezpieczeństwo i nowe funkcje.
  - **ScheduledDefrag** (`Microsoft\Windows\Defrag`): Optymalizuje dyski **HDD** i **SSD**, poprawiając wydajność odczytu/zapisu.
  - **RunFullMemoryDiagnostic** (`Microsoft\Windows\Diagnosis`): Uruchamia diagnostykę pamięci **RAM** przy wykryciu błędów systemowych.
  - **Microsoft Compatibility Appraiser** (`Microsoft\Windows\Application Experience`): Zbiera dane o kompatybilności aplikacji, wspierając aktualizacje systemu.

Aplikacje firm trzecich, takie jak antywirusy (np. **Norton**, **McAfee**) czy oprogramowanie do **backupu** (np. **Acronis**), również tworzą zadania w **Harmonogramie**, np. dla regularnych skanów czy synchronizacji danych.

---

# Podcast AI

<audio src="https://raw.githubusercontent.com/Edu-Koala-V/audio_podcast/refs/heads/main/Windows_11/Audio/Windows Task Scheduler_ Automation and Maintenance.wav" controls>
Twoja przeglądarka nie wspiera odtwarzania plików audio.
</audio>