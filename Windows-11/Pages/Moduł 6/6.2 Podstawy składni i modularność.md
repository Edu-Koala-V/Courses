# 6.2 Podstawy skadni i modularno

## Wprowadzenie

Skoro ju偶 zapoznae si ze rodowiskiem **PowerShell ISE**, czas na pisanie pierwszych skrypt贸w. Ju偶 na starcie zauwa偶ysz, 偶e kodowanie w _**PowerShell**_ jest przyjemniejsze ni偶 pisanie skrypt贸w **BATCH**, g贸wnie dziki kolorowaniu skadni i podpowiedziom. A skoro mowa o kolorystyce, zachcam Ci do zmiany motywu z jasnego na ciemny:

![Ciemny motyw w PowerShell ISE](https://raw.githubusercontent.com/Edu-Koala-V/images/main/Windows_11/Images/powershell-ise-theme-dark.webp)


## Definicje

<div data-hint="info">

**Referencja**: Odwoanie w kodzie do struktury przechowujcej dane, np. zmiennej lub jej wartoci.  
W _**PowerShell**_ referencj do zmiennej jest jej nazwa poprzedzona znakiem dolara (`$`).

</div>


## Tworzenie i uruchamianie skryptu

1.  Uruchom **PowerShell ISE**.
2.  Wpisz kod w edytorze.
3.  Zapisz plik z rozszerzeniem `.ps1` (np. `witaj.ps1`).
4.  Uruchom skrypt w **ISE**, klikajc <img src="https://raw.githubusercontent.com/Edu-Koala-V/images/main/Windows_11/Images/run-green-play.webp" alt="Ikona uruchomienia skryptu w powershell ise" style="display: inline-block; height: 1.2rem; vertical-align: middle;cursor: pointer;"> lub wciskajc klawisz <kbd>F5</kbd>.
5.  Aby uruchomi z konsoli, wpisz: `.\witaj.ps1`.


## Podstawowa skadnia

Oto kluczowe elementy skadni PowerShell:

| Element | Opis | Przykad |
|:---|:---|:---|
| `#` | **Komentarz**, ignorowany przez PowerShell. | `# To jest komentarz` |
| `$zmienna` | **Zmienna** przechowujca dane (tekst, liczby, obiekty). | `$imie = "Janek"` |
| <span style="white-space: nowrap;">`Write-Output`</span> | **Wywietla tekst** lub obiekty w konsoli. | `Write-Output $imie` |
| `Read-Host` | **Pobiera dane** od u偶ytkownika. | `$imie = Read-Host "Podaj imi"` |
| `function` | Definiuje **funkcj**, czyli blok kodu wielokrotnego u偶ytku. | `function Show-Welcome { Write-Output "Witaj!" }` |
| `param()` | Definiuje **parametry** skryptu lub funkcji. | `param($imie)` |


## Pierwszy skrypt: Powitanie

Tak jak w przypadku nauki pisania skrypt贸w **BATCH**, tu te偶 zaczniemy od prostych interakcji z u偶ytkownikiem. Poni偶ej masz kod skryptu, w kt贸rym do zmiennej `$imie` przypisuje si warto podan przez u偶ytkownika po wywietleniu mu komunikatu.

Gdy u偶ytkownik zatwierdzi wpisanie danych klawiszem <kbd>Enter</kbd>, zostan one zapisane w zmiennej `$imie`. Nastpnie, przy pomocy `Write-Output` zostanie wywietlony komunikat.  
Zwr贸 uwag, 偶e _**PowerShell**_ automatycznie zastpuje referencj do zmiennej `$imie` jej zawartoci.

Na koniec, zamiast pisa `pause`, wywoano `Read-Host` z odpowiednim komunikatem, aby skrypt oczekiwa na wcinicie klawisza <kbd>Enter</kbd> przez u偶ytkownika, zanim si zamknie.

```powershell
# Skrypt powitalny
$imie = Read-Host "Podaj swoje imi"
Write-Output ""
Write-Output "Cze, $imie! Witaj w PowerShell! "
Write-Output ""

Read-Host "Wcinij Enter aby zakoczy dziaanie."
```

<div data-hint="info">

Aby doda pust lini tak jak w **BATCH** `echo.`, wystarczy wywoa `Write-Output ""` bez zawartoci komunikatu do wywietlenia.

</div>


## Modularno: Funkcje i skrypty

Znasz ju偶 pojcie modularnoci z **Moduu 5**. Wywoywanie oddzielnych fragment贸w w postaci skrypt贸w **BATCH** za pomoc instrukcji `CALL` pozwalao na czytelniejszy kod, ale te偶 na konieczno zarzdzania wieloma plikami jednoczenie.

Teraz poznasz now skadni do wydzielania fragment贸w kodu wielokrotnego u偶ytku, czyli **funkcje**. Aby zdefiniowa funkcj, nale偶y u偶y sowa kluczowego `function`, nastpnie nada jej nazw i w klamrach (`{}`) zawrze kod, kt贸ry ma by wykonany, gdy ta funkcja zostanie wywoana.

<div data-hint="info">

Nie ma znaczenia, w kt贸rym miejscu zadeklarujesz funkcj w skrypcie.

</div>

## Przykad: Funkcja powitalna

Przepiszmy skrypt z u偶yciem funkcji:

```powershell
# Definicja funkcji przyjmujcej parametr imie i wywoujcej powitanie.
function Show-Welcome {
    param($imie)
    Write-Output "Cze, $imie! Witaj w PowerShell! "
}

$imie = Read-Host "Podaj swoje imi"

# Wywoanie funkcji
Show-Welcome -imie $imie

Read-Host "Wcinij Enter aby zakoczy dziaanie."
```

![Poprawne i nie poprawne przekazanie parametru do wywoania funkcji w PowerShell](https://raw.githubusercontent.com/Edu-Koala-V/images/main/Windows_11/Images/powershell-funkcje-i-parametry.webp)


## Wywoywanie oddzielnego skryptu `.ps1`

Stw贸rz drugi skrypt (`welcome.ps1`):

```powershell
# welcome.ps1
param($imie)
Write-Output "Modu powitalny: Cze, $imie! "
```

W g贸wnym skrypcie wywoaj go, przesyajc zmienn jako pierwszy parametr:

```powershell
# main.ps1
$imie_do_przekazania = Read-Host "Podaj swoje imi"
.\welcome.ps1 $imie_do_przekazania

Read-Host "Wcinij Enter aby zakoczy dziaanie."
```

Pamitaj, 偶e lokalizacja wczytywania skrypt贸w musi by poprawna. W moim przypadku skrypty mam na pulpicie, wic musiaem w konsoli **PowerShell ISE** zmieni lokalizacj.

![Wczytanie oddzielnego pliku skryptu .ps1](https://raw.githubusercontent.com/Edu-Koala-V/images/main/Windows_11/Images/powershell-uruchamianie-skrypt贸w.webp)


---

# Podcast AI

<audio src="https://raw.githubusercontent.com/Edu-Koala-V/audio_podcast/refs/heads/main/Windows_11/Audio/PowerShell Syntax Fundamentals and Modularity.wav" controls>
Twoja przegldarka nie wspiera odtwarzania plik贸w audio.
</audio>